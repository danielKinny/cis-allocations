# CIS Allocations â€“ Automated Committee Allocation System

This is a **Node.js** program designed to handle applications for competitions typically hosted by schools.

Due to the high volume of applications received through Google Forms, the allocation process is often time-consuming. This program automates that process using libraries like `csv-parser` and `xlsx`.

---

## ğŸ”§ Features

- Parses CSV files exported from Google Forms.
- Automatically allocates students based on their committee preferences.
- Generates a formatted `allocations.xlsx` file.
- Segregates unallocated applicants for manual assignment.

---

## ğŸ“‹ Allocation Algorithm

1. **First Preference Check:**  
   Each applicantâ€™s first preference is checked for availability.

2. **Second Preference Check:**  
   If the first preference is full, the second preference is considered.

3. **Experience Check:**
   Checks if the delegate has had sufficient experience to be assigned to the committee.

5. **Fallback Allocation:**  
   If both preferences are full, the participant is added to a separate list (`noCom`) for manual assignment by event organisers.

---

## ğŸš€ Getting Started

### Prerequisites

- Install [Node.js](https://nodejs.org/) and [npm](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm)

### Run the Program

```bash
git clone https://github.com/danielKinny/cis-allocations.git
cd cis-allocations
npm install
node allocation.js
```
After running the above commands, a file named allocations.xlsx will be generated with all the formatted allocations.

ğŸ§¹ Clean Up

To delete generated files:
```bash
node reset.js
```

ğŸ“ Notes

- The input.csv contains ~85 sample participants generated by GitHub Copilot.

- The format for creating each object is detailed in allocation.js.

- All file paths used in reset.js are hardcoded, if you are to change the filepaths passed into
  the main program then reset.js will throw an error, these values can be changed to facilitate cleanups.
  
- All available committees are defined in committees.json.
  You can dynamically add more committees by updating this file.
